syntax = "proto3";

package stock.trading;
// Create the separate java class file
option java_multiple_files = true;
// package for each request and response
option  java_package = "com.grpc.practice";
// Club all individual call into one class
option  java_outer_classname = "StockTradingProto";

// Use service for creating the service
service  StockTradingService {
    // UNARY - RPC - get current stock price --> One request return one response
    rpc getStockPrice(StockRequest) returns (StockResponse);

    // Server streaming RPC -> get multiple stock prices --> One request return multiple responses
    rpc subscribeStockPrice(StockRequest) returns (stream StockResponse);

    // Client streaming RPC -> Send one order summary for multiple stock order request from client--> Multiple request return one response
    rpc bulkStockOrder(stream StockOrder) returns (OrderSummary);

    // Bidirectional streaming RPC -> Send multiple trade status for multiple stock order request from client--> Multiple request return multiple response
    rpc liveTrading(stream StockOrder) returns (stream TradeStatus);
}

// Use message for creating the class
// Note in grpc we can use the path variable or request param
message StockRequest {
    string stock_symbol=1; //=1 -> represents the field position
}

message StockResponse {
    string stock_symbol=1;
    double price=2;
    string timestamp=3;
}

message StockOrder {
    string order_id=1;
    string stock_symbol=2;
    int32 quantity=3;
    double price=4;
    string order_type=5; //BUY or SELL
}

message OrderSummary {
    int32 total_order=1;
    double total_amount=2;
    int32 success_count=3;
}

message TradeStatus {
    string order_id=1;
    string status=2; //execute, failed, pending
    string message=3; // reason if failed or success message
    string timestamp=4;
}